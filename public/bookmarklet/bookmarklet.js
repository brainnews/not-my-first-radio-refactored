javascript:(function(){const t={baseUrl:"https://notmyfirstradio.com",streamPatterns:[/\.mp3(\?.*)?$/i,/\.aac(\?.*)?$/i,/\.m3u8(\?.*)?$/i,/\.m3u(\?.*)?$/i,/\.pls(\?.*)?$/i,/\/stream(\?.*)?$/i,/\/live(\?.*)?$/i,/\/radio(\?.*)?$/i,/icecast/i,/shoutcast/i],excludeDomains:["youtube.com","youtu.be","spotify.com","soundcloud.com","apple.com","music.amazon.com","pandora.com","tidal.com"],maxStreams:10,uiTimeout:1e4},e={isStreamUrl:function(e){if(!e||"string"!=typeof e)return!1;try{const n=new URL(e);return!t.excludeDomains.some(t=>n.hostname.includes(t))&&t.streamPatterns.some(t=>t.test(e))}catch(t){return!1}},getDomain:function(t){try{return new URL(t).hostname}catch(t){return""}},cleanStationName:function(t){return t?t.trim().replace(/\s+/g," ").replace(/[^\w\s\-\.]/g,"").substring(0,100):""},getFaviconUrl:function(){const t=["link[rel=\"icon\"]",'link[rel="shortcut icon"]','link[rel="apple-touch-icon"]','link[rel="apple-touch-icon-precomposed"]'];for(let e of t){const t=document.querySelector(e);if(t&&t.href)return t.href}return window.location.origin+"/favicon.ico"},makeAbsolute:function(t){if(!t)return"";try{return new URL(t,window.location.href).href}catch(e){return t}}},n={findAudioStreams:function(){const t=[];return document.querySelectorAll("audio").forEach(n=>{n.src&&e.isStreamUrl(n.src)&&t.push({url:e.makeAbsolute(n.src),element:n,type:"audio-src"}),n.querySelectorAll("source").forEach(r=>{r.src&&e.isStreamUrl(r.src)&&t.push({url:e.makeAbsolute(r.src),element:n,type:"audio-source",mimeType:r.type})})}),t},findStreamingLinks:function(){const t=[];return document.querySelectorAll("a[href]").forEach(n=>{e.isStreamUrl(n.href)&&t.push({url:e.makeAbsolute(n.href),element:n,type:"link",linkText:n.textContent.trim()})}),t},findJavaScriptStreams:function(){const t=[];return["streamUrl","audioUrl","radioUrl","streamSrc","playlistUrl"].forEach(n=>{try{window[n]&&e.isStreamUrl(window[n])&&t.push({url:e.makeAbsolute(window[n]),type:"javascript-var",varName:n})}catch(t){}}),t},getAllStreams:function(){const t=[...this.findAudioStreams(),...this.findStreamingLinks(),...this.findJavaScriptStreams()],e=[],n=new Set;return t.forEach(t=>{n.has(t.url)||(n.add(t.url),e.push(t))}),e.slice(0,t.maxStreams)}},r={getStationName:function(){const t=[()=>{const t=document.querySelector('meta[property="og:title"]');return t?t.content:null},()=>document.title,()=>{const t=document.querySelector("h1");return t?t.textContent:null},()=>{const t=document.querySelector('meta[name="description"]');return t?t.content:null}];for(let n of t)try{const t=n();if(t&&t.trim())return e.cleanStationName(t)}catch(t){continue}return e.cleanStationName(e.getDomain(window.location.href))},getHomepage:function(){return window.location.origin},getCountryCode:function(){const t=document.documentElement.lang||document.documentElement.getAttribute("xml:lang");return t&&t.includes("-")?t.split("-")[1].toUpperCase():null}},o={showNotification:function(t,e="info"){const n=document.createElement("div");n.style.cssText=`position:fixed;top:20px;right:20px;background:${"error"===e?"#f44336":"success"===e?"#4caf50":"#2196f3"};color:white;padding:12px 20px;border-radius:4px;font-family:Arial,sans-serif;font-size:14px;z-index:999999;box-shadow:0 2px 8px rgba(0,0,0,0.2);max-width:300px;word-wrap:break-word;`,n.textContent=t,document.body.appendChild(n),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n)},5e3)},showStreamSelection:function(n,callback){const overlay=document.createElement("div");let isRemoved=!1;const safeRemove=()=>{!isRemoved&&overlay.parentNode&&(overlay.parentNode.removeChild(overlay),isRemoved=!0)};overlay.style.cssText="position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.7);z-index:999998;display:flex;align-items:center;justify-content:center;font-family:Inter,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;backdrop-filter:blur(4px);";const modal=document.createElement("div");modal.style.cssText="background:#2c2c2c;border-radius:8px;padding:24px;width:90%;max-width:500px;max-height:70vh;overflow-y:auto;box-shadow:0 4px 20px rgba(0,0,0,0.4);border:1px solid #444444;color:#ffffff;";const title=document.createElement("h3");title.textContent="Select Stream to Add",title.style.cssText="margin:0 0 20px 0;color:#ffffff;font-size:1.25rem;font-weight:600;",modal.appendChild(title);const list=document.createElement("div");list.style.cssText="margin-bottom:20px;",n.forEach((stream,idx)=>{const item=document.createElement("div");item.style.cssText="padding:12px;border:1px solid #444444;border-radius:6px;margin-bottom:8px;cursor:pointer;transition:all 0.2s ease;background:#1a1a1a;",item.innerHTML=`<div style="font-weight:600;margin-bottom:6px;color:#ffffff;">${e.getDomain(stream.url)}</div><div style="font-size:12px;color:#a0a0a0;word-break:break-all;margin-bottom:4px;">${stream.url}</div><div style="font-size:11px;color:#666666;">Type: ${stream.type}</div>`,item.addEventListener("mouseenter",()=>{item.style.background="#333333",item.style.borderColor="#9151F0"}),item.addEventListener("mouseleave",()=>{item.style.background="#1a1a1a",item.style.borderColor="#444444"}),item.addEventListener("click",()=>{safeRemove(),callback(stream)}),list.appendChild(item)}),modal.appendChild(list);const cancelBtn=document.createElement("button");cancelBtn.textContent="Cancel",cancelBtn.style.cssText="background:transparent;color:#ffffff;border:1px solid #444444;padding:10px 20px;border-radius:4px;cursor:pointer;font-family:inherit;font-size:14px;transition:all 0.2s ease;",cancelBtn.addEventListener("mouseenter",()=>{cancelBtn.style.background="#444444"}),cancelBtn.addEventListener("mouseleave",()=>{cancelBtn.style.background="transparent"}),cancelBtn.addEventListener("click",()=>{safeRemove()}),modal.appendChild(cancelBtn),overlay.appendChild(modal),document.body.appendChild(overlay),setTimeout(()=>{safeRemove()},t.uiTimeout)}},s={createStationData:function(t){return{url:t.url,name:r.getStationName(),favicon:e.getFaviconUrl(),homepage:r.getHomepage(),countrycode:r.getCountryCode()}},generateAddUrl:function(e){return`${t.baseUrl}/?add=${encodeURIComponent(JSON.stringify(e))}`}};try{o.showNotification("Scanning page for audio streams...","info");const t=n.getAllStreams();if(0===t.length)return void o.showNotification("No audio streams found on this page","error");if(1===t.length){const e=s.createStationData(t[0]),n=s.generateAddUrl(e);return o.showNotification("Opening radio app with detected stream...","success"),void window.open(n,"_blank")}o.showStreamSelection(t,stream=>{const e=s.createStationData(stream),n=s.generateAddUrl(e);o.showNotification("Opening radio app with selected stream...","success"),window.open(n,"_blank")})}catch(t){console.error("Bookmarklet error:",t),o.showNotification("Error detecting streams: "+t.message,"error")}})();